#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>
#include <sys/types.h>
#include <signal.h>
#include <sys/time.h>
#include <sys/resource.h>
#include <string.h>
#include <strings.h>
#include <math.h>


/*******************************************************************************************************/
// from http://www.cs.ucsb.edu/~rich/class/cs290-cloud/code/simple_taboo_search/clique_count.c

// #define sgsize (6)

/*
 ***
 *** returns the number of monochromatic cliques in the graph presented to
 *** it
 ***
 *** graph is stored in row-major order
 *** only checks values above diagonal
 */

int CliqueCount_1(int *g,
    int gsize)
{
  int i;
  int j;
  int k;
  int l;
  int m;
  int n;
  int count=0;

  //////////////////
  int sgsize = 6;
  //////////////////

  for(i=0;i < gsize-sgsize+1; i++)
  {
    for(j=i+1;j < gsize-sgsize+2; j++)
    {
      for(k=j+1;k < gsize-sgsize+3; k++) 
      { 
        if((g[i*gsize+j] == g[i*gsize+k]) && 
            (g[i*gsize+j] == g[j*gsize+k]))
        {
          for(l=k+1;l < gsize-sgsize+4; l++) 
          { 
            if((g[i*gsize+j] == g[i*gsize+l]) && 
                (g[i*gsize+j] == g[j*gsize+l]) && 
                (g[i*gsize+j] == g[k*gsize+l]))
            {
              for(m=l+1;m < gsize-sgsize+5; m++) 
              {
                if((g[i*gsize+j] == g[i*gsize+m]) && 
                    (g[i*gsize+j] == g[j*gsize+m]) &&
                    (g[i*gsize+j] == g[k*gsize+m]) && 
                    (g[i*gsize+j] == g[l*gsize+m]))
                {
                  for(n=m+1;n<gsize-sgsize+6;n++)
                  {
                    if
                      ((g[i*gsize+j] == g[i*gsize+n]) && 
                       (g[i*gsize+j] == g[j*gsize+n]) &&
                       (g[i*gsize+j] == g[k*gsize+n]) && 
                       (g[i*gsize+j] == g[l*gsize+n]) &&
                       (g[i*gsize+j] == g[m*gsize+n]))
                      {
                        count++;
                      }
                  }

                }
              }
            }
          }
        }
      }
    }
  }
  return(count);
}

double CliqueCountG(int *g, int gsize, double *countg)
{
  int i;
  int j;
  int k;
  int l;
  int m;
  int n;
  double count=0.0;
  int sgsize = 6;

  /*
   * zero out countg
   */
  if(countg != NULL)
  {
    memset(countg,0,gsize*gsize*sizeof(double));
  }

  for(i=0;i < gsize-sgsize+1; i++)
  {
    for(j=i+1;j < gsize-sgsize+2; j++)
    {
      for(k=j+1;k < gsize-sgsize+3; k++) 
      { 
        if((g[i*gsize+j] == g[i*gsize+k]) && 
            (g[i*gsize+j] == g[j*gsize+k]))
        {
          for(l=k+1;l < gsize-sgsize+4; l++) 
          { 
            if((g[i*gsize+j] == g[i*gsize+l]) && 
                (g[i*gsize+j] == g[j*gsize+l]) && 
                (g[i*gsize+j] == g[k*gsize+l]))
            {
              for(m=l+1;m < gsize-sgsize+5; m++) 
              {
                if((g[i*gsize+j] == g[i*gsize+m]) && 
                    (g[i*gsize+j] == g[j*gsize+m]) &&
                    (g[i*gsize+j] == g[k*gsize+m]) && 
                    (g[i*gsize+j] == g[l*gsize+m]))
                {
                  for(n=m+1;n<gsize-sgsize+6;n++)
                  {
                    if
                      ((g[i*gsize+j] == g[i*gsize+n]) && 
                       (g[i*gsize+j] == g[j*gsize+n]) &&
                       (g[i*gsize+j] == g[k*gsize+n]) && 
                       (g[i*gsize+j] == g[l*gsize+n]) &&
                       (g[i*gsize+j] == g[m*gsize+n]))
                      {
                        count++;
                        if(countg != NULL)
                        {
                          countg[i*gsize+j]++;  countg[i*gsize+k]++;
                          countg[i*gsize+l]++;  countg[i*gsize+m]++;
                          countg[i*gsize+n]++;  countg[j*gsize+k]++;
                          countg[j*gsize+l]++;  countg[j*gsize+m]++;
                          countg[j*gsize+n]++;  countg[k*gsize+l]++;
                          countg[k*gsize+m]++;  countg[k*gsize+n]++;
                          countg[l*gsize+m]++;  countg[l*gsize+n]++;
                          countg[m*gsize+n]++;
                        }
                      }
                  }

                }
              }
            }
          }
        }
      }
    }
  }
  return(count);
}
/*******************************************************************************************************/

/*******************************************************************************************************/
// from http://www.cs.ucsb.edu/~rich/class/cs290-cloud/code/simple_taboo_search/simple_taboo_search-6.c

/*
 ***
 *** returns the number of monochromatic cliques in the graph presented to
 *** it
 ***
 *** graph is stored in row-major order
 *** only checks values above diagonal
 */

int CliqueCount_2(int *g, int gsize)
{
  int i;
  int j;
  int k;
  int l;
  int m;
  int n;
  int count=0;
  int sgsize = 6;

  for(i=0;i < gsize-sgsize+1; i++)
  {
    for(j=i+1;j < gsize-sgsize+2; j++)
    {
      for(k=j+1;k < gsize-sgsize+3; k++) 
      { 
        if((g[i*gsize+j] == g[i*gsize+k]) && 
            (g[i*gsize+j] == g[j*gsize+k]))
        {
          for(l=k+1;l < gsize-sgsize+4; l++) 
          { 
            if((g[i*gsize+j] == g[i*gsize+l]) && 
                (g[i*gsize+j] == g[j*gsize+l]) && 
                (g[i*gsize+j] == g[k*gsize+l]))
            {
              for(m=l+1;m < gsize-sgsize+5; m++) 
              {
                if((g[i*gsize+j] == g[i*gsize+m]) && 
                    (g[i*gsize+j] == g[j*gsize+m]) &&
                    (g[i*gsize+j] == g[k*gsize+m]) && 
                    (g[i*gsize+j] == g[l*gsize+m])) {
                  for(n=m+1; n < gsize-sgsize+6; n++)
                  {
                    if((g[i*gsize+j]
                          == g[i*gsize+n]) &&
                        (g[i*gsize+j] 
                         == g[j*gsize+n]) &&
                        (g[i*gsize+j] 
                         == g[k*gsize+n]) &&
                        (g[i*gsize+j] 
                         == g[l*gsize+n]) &&
                        (g[i*gsize+j] 
                         == g[m*gsize+n])) {
                      count++;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return(count);
}

/*******************************************************************************************************/


int* convert_to_int(char* graph, int gsize) {
  int *new_graph = (int*)malloc(gsize * gsize * sizeof(int));
  int i, j;
  for (i = 0; i < gsize; ++i) {
    for (j = 0; j < gsize; ++j) {
      *(new_graph + i*gsize + j) = *(graph + i*gsize + j) - '0';
    }
  }

  return new_graph;
}

void print_graph(int* graph, int gsize) {
  int i,j;
  printf("gsize = %d\n", gsize);
  for (i = 0; i < gsize; ++i) {
    for (j = 0; j < gsize; ++j) {
      printf("%d", *(graph + i*gsize + j));
    }
    printf("\n");
  }
}

void ccount(int* graph, int gsize){
  printf("CliqueCount_2 = %d\n", CliqueCount_2(graph, gsize));
}

int main() {
  int i, j;
  char g[] = "0100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100010011100100100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100010011100000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100010011100000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100010011100000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100010011000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100010010000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100010000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100010000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100010000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101100000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101101000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101100000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101100000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111101000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111100000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111100000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111111000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111110000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111100000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000111000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000110000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000100000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010110000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010100000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110010000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000110000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000100000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010100000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101010000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100101000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100100000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100100000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010100000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101010000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000101000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000100000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000100000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001100000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101001000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001101000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001100000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001100000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100001000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111100000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111111000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111110000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111100000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110111000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110110000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110100000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110110000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110100000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
  int gsize = 101;

  int *graph = convert_to_int(g, gsize);
  // print_graph(graph, gsize);
  ccount(graph, gsize);

  int new_gsize = gsize + 1;
  int *new_graph = malloc(new_gsize * new_gsize * sizeof(int));
  for (i = 0; i < new_gsize; ++i) {
    *(new_graph + i) = 0;
  }
  for (i = 1; i < new_gsize; ++i) {
    for (j = 0; j < new_gsize; ++j) {
      if (j == 0)
        *(new_graph + i*new_gsize + j) = 0;
      else
        *(new_graph + i*new_gsize + j) = *(graph + (i-1)*gsize + (j-1));
    }
  }

  // print_graph(new_graph, new_gsize);
  ccount(new_graph, new_gsize);


  return 0;
}
